(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{538:function(s,e,t){"use strict";t.r(e);var n=t(4),a=Object(n.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("由于"),t("a",{attrs:{href:"https://www.zhihu.com/question/21128056",target:"_blank",rel:"noopener noreferrer"}},[s._v("CNAME 和 MX 冲突的原因"),t("OutboundLink")],1),s._v("，我把我的个人博客（静态）部署在自己的 server 上了。")]),s._v(" "),t("p",[s._v("这其实挺傻逼的，毕竟这么好用的 Github Pages / "),t("a",{attrs:{href:"https://coding.net/pages",target:"_blank",rel:"noopener noreferrer"}},[s._v("Coding Pages"),t("OutboundLink")],1),s._v(" 就与我无缘了。其实真可以考虑使用 www.wusisu.com 而不是 wusisu.com。")]),s._v(" "),t("p",[s._v("不管怎么说，现在我遇到了持续部署的问题。这个问题总归是需要解决的，毕竟 CD 是每一个程序员的追求。")]),s._v(" "),t("p",[s._v("通过看 Webhook 的"),t("a",{attrs:{href:"https://developer.github.com/webhooks/",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),t("OutboundLink")],1),s._v(" 和实操，提供代码如下。")]),s._v(" "),t("p",[s._v("（脚本竟然不在仓库里，迟点更新上来）\n接受 Webhook 的脚本：\nhttps://github.com/wusisu/wusisu.com/tree/00be243bdf0707302cb28e24d96273a9887f034f/server/blog_listen")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<script src="https://gist.coding.net/u/wusisu/20d43c68e80a4f08a44ebc09ed20aa92.js"><\/script>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后执行即可 "),t("code",[s._v("php -S 0.0.0.0:51234")])]),s._v(" "),t("p",[s._v("执行部署的脚本：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/repos/wusisu.com\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" fetch\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --hard origin/master\nbundle "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" jekyll build\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r _site/* /web/wusisu.com/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("当然 GitHub 上需要配置 https://github.com/wusisu/wusisu.com/settings/hooks")]),s._v(" "),t("p",[s._v("如此，我只用在 github 上创建文件，就能部署我的博客了。\n比如此文就是如此。")])])}),[],!1,null,null,null);e.default=a.exports}}]);